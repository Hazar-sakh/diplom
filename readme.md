# Сравнение различных библиотек для визуализации данных: Matplotlib, Seaborn и Plotly

Предлагается создать набор визуализаций с использованием библиотек Matplotlib, Seaborn и Plotly, сравнить их функциональность и удобство использования.
Matplotlib, Seaborn и Plotly являются библиотеками для построения графиков массивов в Python, следовательно для реализации практической части содержания работы потребуется некоторый массив данных.

![Вступительное демо](https://github.com/Hazar-sakh/diplom/blob/master/demos/demo.jpg)

## Содержание
1. [Обзор проекта](## Обзор проекта)
2. [Структура проекта](#Структура проекта)
3. [Обзор библиотек и реализация визуализации:](#Обзор библиотек и реализация визуализации:)
   - [Matplotlib](#Matplotlib)
   - [Seaborn](#Seaborn)
   - [Plotly](#Plotly)
4. [Сравнительный анализ библиотек](#Сравнительный анализ библиотек)
5. [Заключение](#Заключение)

## Обзор проекта
Matplotlib, Seaborn и Plotly являются библиотеками для построения графиков массивов в Python, следовательно для реализации практической части содержания работы потребуется некоторый массив данных.
Используем данные ООО «Курильский Универсальный Комплекс» (место работы автора) по выдаче матросу средств индивидуальной защиты в период с 2014 по 2024 годы. 

Данные представлены в виде таблицы Excel, в связи с чем потребуется использование дополнительных библиотек: openpyxl – для считывания данных из таблицы и pandas для оперирования данными и их предобработки.
Вместе с тем, для удобства сравнения библиотек и представления результатов предлагаем обернуть программу в пользовательский интерфейс с помощью библиотеки PySide6.
Для измерения скорости быстродействия воспользуемся стандартной библиотекой datatime.

Критерии оценки исследуемых библиотек будет включать следующие пункты:

   1.	Особенности предобработки данных
   2.	Простоту построения графика без параметров стилизации
   3.	Полноту отображения информации
   4.	Быстродействие
   
В целях обеспечения объективности оценки библиотек остановимся на следующей методике: 
   1. с помощью каждой библиотеки будут построены графики двух типов:
       a.	упрощенный – включает один параметр;
       b.	усложненный – включает все параметры;
   4. быстродействие будет учитывать время между получением входных данных и завершением вывода графика;
   5. время предобработки данных не учитывается, поскольку форма поступающих данных зависит исключительно от программы и идеи реализуемого проекта, что не влияет на реализацию функций исследуемых библиотек;
   6. способ построения графиков будет субъективно простым;
   7. оценки субъективного характера (красота графиков, цветовые гаммы и т.п.) отводятся на второй план и будут рассмотрены в заключении.
        
    
## Структура проекта
Проект включает:
   1. Файл main.py, содержащий в себе код, объединяющий GUI и backend, считывающий таблицу excel, осуществляющий предобработку данных.
   2. Файл ui_main.py, содержащий в себе код GUI.
   3. Файлы by_matplotlib.py, by_plotly.py и by_seaborn.py, содержащие в себе код построения и сохранения графиков, и размещенные в директории Backend.
   4. Генерируемые программой файлы изображений графиков для их дальнейшего представления, размещенные в директориях simple_plots для простых графиков и complicated_plots для усложненных.

Для начала установим необходимые библиотеки с помощью pip install (см. Приложение 1. [Список необходимых библиотек](https://github.com/Hazar-sakh/diplom/blob/master/requirements.txt)).

Далее создадим пользовательский интерфейс с помощью библиотеки PySide6 и встроенного редактора QtDesigner.

Задача интерфейса предоставить пользователю форму для выбора таблицы excel, параметра таблицы, который необходимо визуализировать, и представление графиков в виде изображений.

Также, в GUI включим сведения о быстродействии исполнения подпрограмм построения графиков.
![Главное окно](https://github.com/Hazar-sakh/diplom/blob/master/demos/ГУИ.jpg)

Добавим отдельное окно для демонстрации графиков:
![Окно демонстарции графиков](https://github.com/Hazar-sakh/diplom/blob/master/demos/демо.png)

После построения GUI и формирования файла ui_main.ui преобразуем его в ui_main.py для последующей работы.
Создадим файл main.py, в который импортируем необходимые для дальнейшей работы библиотеки, а также напишем класс, наследуемый от Ui_MainWindow.

## Обзор библиотек и реализация визуализации:
### Matplotlib
Matplotlib - популярная Python-библиотека для визуализации данных. Она используется для создания любых видов графиков: линейных, круговых диаграмм, построчных гистограмм и других - в зависимости от задач.
Matplotlib была написана американским нейробиологом Джоном Хантером (англ. John Hunter) и распространяется на условиях BSD-подобной лицензии.
Изначально Хантер разработал Matplotlib во время постдокторантуры по нейробиологии для визуализации данных электрокортикографии (ЭКоГ) у пациентов с эпилепсией.
Библиотека была создана для имитации графических команд MATLAB, она не зависит от MATLAB и может использоваться в объектно-ориентированном стиле Python. Хотя Matplotlib написана на чистом Python, она активно использует NumPy и другие расширения для обеспечения высокой производительности даже для больших массивов.
Matplotlib использовалась для визуализации данных во время посадки космического аппарата «Феникс» на Марс в 2008 году и для создания первого изображения чёрной дыры.
Пример построения упрощенного и усложненного графиков с помощью Matplotlib:
  ```python
  # Импортируем необходимые библиотеки для работы
  import matplotlib.pyplot as plt # Для работы с графиком
  import datetime # Для измерения времени работы
  import numpy as np
  
  # V V V Создаем для удобства список глобальных переменных, которыми будем пользоваться
  # period - период для представления
  # norm_name - название нормы
  # norm_nums - список значений нормы по количеству периодов
  # name - название объекта представления
  # stat - статистика объекта представления
  # stat_h - статистика объектов представления всех параметров
  # df - датафрейм для простого графика Seaborn
  # df_sns_h - датафрейм для усложненного графика Seaborn
  
  # Строим простейший график в функцию которого передаем значения периода, нормы и статистики
  def simple_mpl(period, norm_nums, stat):
      t_mpl1 = datetime.datetime.now() # Задаем время начала работы функции
      plt.plot(period, stat) # Добавляем линию статистики
      plt.plot(period, norm_nums) # Добавляем линию нормы
      plt.savefig('simple_plots/simple_mpl.png') # Сохраняем график в виде изображения
      t_mpl2 = datetime.datetime.now() # Задаем время окончания работы функции
      plt.close() # Закрываем график с освобождением ресурсов
      return f'{t_mpl2 - t_mpl1}' # Возвращаем время работы функции
  
  # Строим усложненный график в функцию которого передаем значения периода и статистики
  def hard_mpl(period, stat_h):
      t_mpl1 = datetime.datetime.now() # Задаем время начала работы функции
      for i in stat_h: # Добавляем все линии циклом for для каждого списка из списка статистки
          plt.plot(period, i)
      plt.savefig('complicated_plots/compl_mpl.png') # Сохраняем график в виде графического изображения
      t_mpl2 = datetime.datetime.now() # Задаем время окончания работы функции
      plt.close() # Закрываем график с освобождением ресурсов
      return f'{t_mpl2 - t_mpl1}' # Возвращаем время работы функции
  ```

### Seaborn
Seaborn — это библиотека для создания статистической графики на Python. Она основана на Matplotlib и тесно интегрируется со структурами данных pandas.
Seaborn помогает изучать и понимать данные. Его функции построения графиков работают с datafraim’ами и массивами, содержащими целые наборы данных, и выполняют необходимое семантическое сопоставление и статистическую агрегацию для создания информативных графиков. Его API, ориентирован на наборы данных, позволяет сосредоточиться на том, что означают различные элементы ваших графиков, а не на деталях их построения.
Seaborn для построения графиков неявно использует Matplotlib, создаёт полноценную графику с помощью одного вызова функции: при необходимости его функции автоматически добавляют информативные подписи к осям и легенды, которые объясняют семантические соответствия на графике.
Во многих случаях Seaborn также выбирает значения параметров по умолчанию в зависимости от характеристик данных.
Интеграция Seaborn с Matplotlib позволяет использовать его во многих средах, которые поддерживает Matplotlib, включая исследовательский анализ данных, взаимодействие в реальном времени в приложениях с графическим интерфейсом и архивирование в различных растровых и векторных форматах.
Сочетание высокоуровневого интерфейса Seaborn и широких возможностей настройки Matplotlib позволяет быстро изучать данные и создавать графику, которую можно адаптировать для публикации.
Seaborn был разработан специалистом по машинному обучению и нейробиологии компании Modal Labs Майклом Уаскомом (англ. Michael Waskom) и выпущен в 2014 году. Основная цель Seaborn — упростить создание сложных визуализаций и улучшить эстетику графиков, что делает его идеальным для быстрого анализа данных.
В академических кругах Seaborn часто применяется для визуализации результатов, которые затем публикуются в научных статьях и журналах. Графики, созданные с помощью неё, используются для демонстрации результатов экспериментов, а также для построения информативных графических абстракций, поддерживающих аргументацию исследований.
В бизнес-сфере Seaborn служит ключевым инструментом для визуализации данных, помогая аналитикам представлять сложные выводы в понятной форме для принятия решений. Графики, построенные с использованием этой библиотеки, могут украшать доклады и презентации, делая данные доступными для неподготовленной аудитории.

### Plotly
Plotly - это компания, занимающаяся техническими вычислениями, со штаб-квартирой в Монреале, которая разрабатывает онлайн-инструменты для анализа данных и визуализации. Plotly предоставляет онлайн-инструменты для построения графиков, аналитики и статистики для индивидуальных пользователей и совместной работы, а также научные графические библиотеки для Python, R, MATLAB, Perl, Julia, Arduino, JavaScript и REST.
Компания была основана Алексом Джонсоном, Джеком Пармером, Крисом Пармером и Мэтью Сандквистом.
Основатели имеют опыт работы в сфере науки, энергетики, анализа и визуализации данных. Среди первых сотрудников - Кристоф Вио, канадский инженер-программист, и Бен Постлтуэйт, канадский геофизик.
Plotly также упрощает создание интерактивных графиков. Интерактивные графики не только красиво выглядят, но и позволяют публике более внимательно изучить каждую точку на графике. С помощью Plotly достаточно легко создавать сложные графики, он отлично подходит для создания интерактивных и качественных графиков при помощи нескольких строк кода.
Благодаря своей гибкости и простоте использования библиотека широко используется в различных областях: анализ данных, научные исследования, финансы, веб-разработка и других.
















